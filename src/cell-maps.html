<!DOCTYPE html>
<html>
<head>
    <title>Cell Maps</title>

    <!-- build:[src] vendor/ -->
    <script src="../lib/jsorolla/vendor/platform.js"></script>
    <script src="../lib/jsorolla/vendor/polymer/polymer.js"></script>
    <!-- /build -->

    <link rel="import" href="../lib/jsorolla/src/network-viewer/cm-toolbar.html">
    <link rel="import" href="plugins/reactome-plugin.html">

    <!-- build:[href] components/ -->
    <link rel="import" href="../lib/jsorolla/src/lib/components/jso-color-picker.html">
    <!-- /build -->

    <script src="../lib/jsorolla/vendor/modernizr.custom.01488.js"></script>

</head>
<body>
<!-- build:[href] vendor/font-awesome/css/ -->
<link rel="stylesheet" href="../lib/jsorolla/vendor/font-awesome/css/font-awesome.min.css">
<!-- /build -->

<!-- build:[href] vendor/ext-5/theme-babel/ -->
<link rel="stylesheet" href="../lib/jsorolla/vendor/ext-5/theme-babel/theme-babel-all.css">
<!-- /build -->

<!-- build:[href] vendor/ -->
<link rel="stylesheet" href="../lib/jsorolla/vendor/jquery.qtip.min.css"/>
<link rel="stylesheet" href="../lib/jsorolla/vendor/jquery.simplecolorpicker.css">
<!-- /build -->


<!-- build:[href] styles/css/ -->
<link type="text/css" rel="stylesheet" href="../lib/jsorolla/styles/css/style.css"/>
<!-- /build -->

<!-- build:[src] vendor/ext-5/  -->
<script src="../lib/jsorolla/vendor/ext-5/ext-all.js"></script>
<!-- /build -->
<script type="text/javascript"
        src="http://cdn.sencha.io/ext/gpl/5.0.0/build/packages/ext-charts/build/ext-charts.js"></script>

<script>
    WORKERS_PATH = "./";
</script>


<!-- build:[src] vendor/  -->
<script src="../lib/jsorolla/vendor/underscore-min.js"></script>
<script src="../lib/jsorolla/vendor/backbone-min.js"></script>
<script src="../lib/jsorolla/vendor/jquery.min.js"></script>
<script src="../lib/jsorolla/vendor/rgbcolor.js"></script>
<script src="../lib/jsorolla/vendor/canvg.js"></script>
<script src="../lib/jsorolla/vendor/xml2json.js"></script>
<script src="../lib/jsorolla/vendor/jszip.min.js"></script>
<script src="../lib/jsorolla/vendor/xlsx.min.js"></script>
<script src="../lib/jsorolla/vendor/jxon.js"></script>


<!-- These dependencies must go AFTER jquery -->
<script src="../lib/jsorolla/vendor/jquery.qtip.min.js"></script>
<script src="../lib/jsorolla/vendor/jquery.cookie.js"></script>
<script src="../lib/jsorolla/vendor/jquery.sha1.js"></script>
<script src="../lib/jsorolla/vendor/purl.min.js"></script>
<script src="../lib/jsorolla/vendor/jquery.simplecolorpicker.js"></script>
<script src="../lib/jsorolla/vendor/d3.min.js"></script>
<!-- /build -->

<!-- build:js nv-config.js  -->
<script src="../lib/jsorolla/src/network-viewer/nv-config.js"></script>
<!-- /build -->

<script src="../conf/config.js"></script>


<!-- build:js network-viewer.min.js -->
<script type="text/javascript" src="../lib/jsorolla/src/lib/svg.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/utils.js"></script>

<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/ux-window.js"></script>

<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/network/network-edit-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/network/layout-configure-widget.js"></script>
<script type="text/javascript"
        src="../lib/jsorolla/src/lib/widgets/network/attribute-layout-configure-widget.js"></script>

<script type="text/javascript" src="../lib/jsorolla/src/lib/network/attributes/attribute-manager-idb.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/attributes/attribute-manager-store.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/network.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/network-session.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/network-config.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/graph.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/edge.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/edge-config.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/vertex.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/vertex-config.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/default-vertex-renderer.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/circos-vertex-renderer.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/default-edge-renderer.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/graph-layout.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/point.js"></script>

<script type="text/javascript" src="../lib/jsorolla/src/lib/cellbase-manager.js"></script>

<script type="text/javascript" src="../lib/jsorolla/src/lib/opencga-manager.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/opencga/generic-form-panel.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/opencga/check-browser.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/opencga/header-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/opencga/job-list-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/opencga/login-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/opencga/opencga-browser-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/opencga/profile-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/opencga/result-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/opencga/result-table.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/opencga/upload-widget.js"></script>

<script type="text/javascript" src="../lib/jsorolla/src/lib/data-adapter/network/dot-network-data-adapter.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/data-adapter/network/json-network-data-adapter.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/data-adapter/network/sif-network-data-adapter.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/data-adapter/network/text-network-data-adapter.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/data-adapter/network/xlsx-network-data-adapter.js"></script>
<script type="text/javascript"
        src="../lib/jsorolla/src/lib/data-adapter/network/attribute-network-data-adapter.js"></script>

<script type="text/javascript" src="../lib/jsorolla/src/lib/data-source/data-source.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/data-source/file-data-source.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/data-source/string-data-source.js"></script>

<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/network/network-file-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/network/dot-network-file-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/network/json-network-file-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/network/sif-network-file-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/network/text-network-file-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/network/xlsx-network-file-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/widgets/network/attribute-network-file-widget.js"></script>

<script type="text/javascript"
        src="../lib/jsorolla/src/lib/widgets/network/attributes/attribute-edit-widget.js"></script>
<script type="text/javascript"
        src="../lib/jsorolla/src/lib/widgets/network/attributes/attribute-filter-widget.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/attributes/attribute-manager-store.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/lib/network/attributes/attribute-manager-idb.js"></script>

<script type="text/javascript" src="../lib/jsorolla/src/network-viewer/tool-bar.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/network-viewer/edition-bar.js"></script>
<script type="text/javascript" src="../lib/jsorolla/src/network-viewer/network-svg-layout.js"></script>

<script type="text/javascript" src="../lib/jsorolla/src/network-viewer/network-viewer.js"></script>


<script type="text/javascript">
    WORKERS_PATH = "../lib/jsorolla/src/lib/";
</script>
<!-- /build -->


<!-- build:js cell-maps.min.js -->
<script type="text/javascript" src="plugins/fatigo-plugin.js"></script>
<script type="text/javascript" src="plugins/intact-plugin.js"></script>
<script type="text/javascript" src="plugins/reactome-plugin.js"></script>
<script type="text/javascript" src="plugins/cellbase-plugin.js"></script>
<script type="text/javascript" src="plugins/intact-plugin.js"></script>
<script type="text/javascript" src="plugins/communities-structure-detection-plugin.js"></script>
<script type="text/javascript" src="plugins/topological-study-plugin.js"></script>

<script type="text/javascript" src="forms/reactome-fi-microarray-form.js"></script>
<script type="text/javascript" src="forms/snow-form.js"></script>
<script type="text/javascript" src="forms/network-miner-form.js"></script>
<script type="text/javascript" src="forms/fatigo-form.js"></script>


<script type="text/javascript" src="visual-attribute-widget/visual-attribute-widget.js"></script>
<script type="text/javascript" src="visual-attribute-widget/pie-attribute-widget.js"></script>

<script type="text/javascript" src="visual-attribute-widget/attribute-control/attribute-control.js"></script>
<script type="text/javascript" src="visual-attribute-widget/attribute-control/color-attribute-control.js"></script>
<script type="text/javascript" src="visual-attribute-widget/attribute-control/number-attribute-control.js"></script>
<script type="text/javascript" src="visual-attribute-widget/attribute-control/select-attribute-control.js"></script>

<script type="text/javascript" src="visual-attribute-widget/attribute-grid/attribute-grid.js"></script>
<script type="text/javascript" src="visual-attribute-widget/attribute-grid/string-attribute-grid.js"></script>
<script type="text/javascript" src="visual-attribute-widget/attribute-grid/number-attribute-grid.js"></script>
<script type="text/javascript" src="visual-attribute-widget/attribute-grid/list-string-attribute-grid.js"></script>
<script type="text/javascript" src="visual-attribute-widget/attribute-grid/list-number-attribute-grid.js"></script>

<script type="text/javascript" src="cell-maps-configuration.js"></script>
<script type="text/javascript" src="cell-maps.js"></script>
<!-- /build -->


<script>
    CELLBASE_HOST = "http://www.ebi.ac.uk/cellbase/webservices/rest";
    CELLBASE_VERSION = "v3";
    //    Ext.Loader.setConfig({enabled: true});
    //        Ext.Loader.setPath('Ext.chart', 'http://cdn.sencha.io/ext/gpl/5.0.0/packages/sencha-charts/src');
    //    //    Ext.QuickTips.init();
    //    Ext.require([
    //        'Ext.grid.plugin.BufferedRenderer'
    //    ]);

    var cellMaps;
    var session
    var resizeTimer;
    Ext.onReady(function () {

        session = new NetworkSession();

        var save_count = 0;
        if (localStorage.getItem('CELLMAPS_SESSION') !== null) {
            session.loadJSON(JSON.parse(localStorage.getItem('CELLMAPS_SESSION')));
        }
        cellMaps = new CellMaps({
            target: 'application',
            session: session,
            width: $(document).width(),
            height: $(document).height(),
            handlers: {
                'session:save-request': function (e) {
                    localStorage.setItem('CELLMAPS_SESSION', JSON.stringify(session));
                    save_count++;
                    console.log('Session saved: ' + save_count);
                }
            }
        });
        cellMaps.draw();

        setTimeout(function () {
            var intervalId = setInterval(function () {
                console.time('Save session');
                cellMaps.saveSession();
                localStorage.setItem('CELLMAPS_SESSION', JSON.stringify(session));
                save_count++;
                console.log('Session saved: ' + save_count);
                console.timeEnd('Save session')
            }, 10000);
        }, 10000);

        // Resize
        $(window).resize(function (event) {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function () {
                cellMaps.resize({
                    width: $(document).width(),
                    height: $(document).height()
                });
            }, 500);
        });
    });


</script>

<STYLE type="text/css">
    html {
        position: fixed;
        overflow: hidden;
        height: 100%;
        width: 100%;
    }

    #status {
        height: 26px;
        border-color: lightgrey;
        border-style: solid;
        /*border-width: 0 1px 1px 1px;*/
        border-width: 1px 0px 0px 0px;
    }

    body {
        /*background-color: #f5f5f5;*/
        /*padding: 4px;*/
    }

    .header-form {
        font-size: 16px;
        line-height: 22px;
        padding: 4px 6px;
        border: 1px solid #000000;
    }

    ul.ocb-header > li.title {
        font-size: 30px;
        padding-left: 30px;
    }
</STYLE>
<div id="checkBrowser"></div>
<div id="application"></div>

</body>
</html>

